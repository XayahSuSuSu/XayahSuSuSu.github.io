(function(e){function t(t){for(var a,l,s=t[0],o=t[1],c=t[2],d=0,f=[];d<s.length;d++)l=s[d],Object.prototype.hasOwnProperty.call(r,l)&&r[l]&&f.push(r[l][0]),r[l]=0;for(a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a]);u&&u(t);while(f.length)f.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],a=!0,s=1;s<n.length;s++){var o=n[s];0!==r[o]&&(a=!1)}a&&(i.splice(t--,1),e=l(l.s=n[0]))}return e}var a={},r={app:0},i=[];function l(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,l),n.l=!0,n.exports}l.m=e,l.c=a,l.d=function(e,t,n){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(l.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)l.d(n,a,function(t){return e[t]}.bind(null,a));return n},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],o=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var u=o;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var a=n("8a23"),r=n.n(a);r.a},"0918":function(e,t,n){},2148:function(e,t,n){"use strict";var a=n("3f05"),r=n.n(a);r.a},3953:function(e,t,n){"use strict";var a=n("0918"),r=n.n(a);r.a},"3f05":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),r=n("f309");a["a"].use(r["a"]);var i=new r["a"]({}),l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",[n("v-content",[n("v-container",{staticClass:"fill-height",attrs:{fluid:""}},[n("v-row",{attrs:{align:"center",justify:"center"}},[n("v-col",{attrs:{cols:"12",sm:"10",md:"8"}},[n("header",[n("h1",[e._v("Boot Repacker by MoKee")])]),n("v-expansion-panels",{attrs:{accordion:"",mandatory:"",readonly:!e.file},model:{value:e.panel,callback:function(t){e.panel=t},expression:"panel"}},[n("v-expansion-panel",[n("v-expansion-panel-header",[null==e.file?n("strong",[e._v("1. Open an existing image")]):n("strong",[e._v("1. Image: "+e._s(e.file.name))])]),n("v-expansion-panel-content",[n("FileDrop",{on:{change:e.handleFile}})],1)],1),n("v-expansion-panel",[n("v-expansion-panel-header",[n("strong",[e._v("2. Customize")])]),n("v-expansion-panel-content",[n("Form",{attrs:{initial:e.initial,values:e.values},on:{change:e.handleChange,replace:e.handleReplace,remove:e.handleRemove,export:e.handleExport}}),n("div",{staticClass:"d-flex"},[n("v-btn",{attrs:{color:"primary",text:""},on:{click:e.handleResetAll}},[n("v-icon",{attrs:{left:""}},[e._v("mdi-restore")]),e._v(" Reset all")],1),n("v-btn",{staticClass:"ml-auto",staticStyle:{"margin-right":"1em"},attrs:{color:"primary",text:""},on:{click:function(t){e.panel=0}}},[e._v("Back")]),n("v-btn",{attrs:{color:"primary",depressed:""},on:{click:function(t){e.panel=2}}},[e._v("Next")])],1)],1)],1),n("v-expansion-panel",[n("v-expansion-panel-header",[n("strong",[e._v("3. Export")])]),n("v-expansion-panel-content",[n("div",{staticClass:"d-flex flex-column justify-center align-center",staticStyle:{"padding-top":"40px","padding-bottom":"40px"}},[n("v-btn",{attrs:{color:"primary",depressed:"",large:""},on:{click:e.handleBuild}},[n("v-icon",{attrs:{left:""}},[e._v("mdi-download")]),e._v(" Export ")],1)],1)])],1)],1),n("footer",[e._v(" Copyright Â© 2020 MoKee Open Source Project ")])],1)],1)],1)],1)],1)},s=[],o=(n("b0c0"),n("d3b7"),n("25f0"),n("ddb0"),n("ade3")),c=n("5530"),u=(n("96cf"),n("1da1")),d=n("21a6"),f=n("cc06"),v=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("upload",{ref:"upload",staticClass:"upload",attrs:{accept:".img",drop:!0,"drop-directory":!1},on:{"input-file":e.selectFile},model:{value:e.files,callback:function(t){e.files=t},expression:"files"}},[e.uploader&&e.uploader.dropActive?n("div",{staticClass:"upload-hint active",domProps:{innerHTML:e._s("Drop the image here")}}):e.selected?n("div",{staticClass:"upload-hint selected"},[e._v(e._s(e.selected?e.selected.name:null))]):n("div",{staticClass:"upload-hint",domProps:{innerHTML:e._s("Drop or <a>select</a> an image")}})])},h=[],p=(n("8a79"),n("8019")),m=n.n(p),b={name:"App",components:{upload:m.a},data:function(){return{files:[],uploader:null,selected:null}},mounted:function(){this.uploader=this.$refs.upload},watch:{selected:function(e){this.$emit("change",e)}},methods:{selectFile:function(e){e&&e.name.endsWith(".img")?this.selected=e.file:this.selected=null}}},_=b,g=(n("2148"),n("2877")),x=Object(g["a"])(_,v,h,!1,null,null,null),y=x.exports,z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-row",[n("v-col",{attrs:{cols:"6",lg:"3"}},[n("ValuePresenter",{attrs:{label:"Magic",initial:e.initial.magic,value:e.initial.magic}})],1),n("v-col",{attrs:{cols:"6",lg:"3"}},[n("ValueEditor",{attrs:{label:"Page size",dec:!0,initial:e.initial.page_size,value:e.values.page_size},on:{change:function(t){return e.handleChange("page_size",t)}}})],1),n("v-col",{attrs:{cols:"6",lg:"3"}},[n("SelectEditor",{attrs:{label:"Header version",items:e.header_versions,initial:e.initial.header_version,value:e.values.header_version},on:{change:function(t){return e.handleChange("header_version",t)}}})],1),n("v-col",{attrs:{cols:"6",lg:"3"}},[n("ValuePresenter",{attrs:{label:"Header size",initial:e.initial.header_size,value:e.values.header_size}})],1)],1),n("v-row",[n("v-col",{attrs:{cols:"12"}},[n("ValuePresenter",{attrs:{label:"Image ID",initial:e.initial.img_id,value:e.values.img_id}})],1)],1),n("v-row",[n("v-col",{attrs:{cols:"6",lg:"3"}},[n("ValuePresenter",{attrs:{label:"Kernel size",initial:e.initial.kernel_size,value:e.values.kernel_size}})],1),n("v-col",{attrs:{cols:"6",lg:"3"}},[n("ValueEditor",{attrs:{label:"Kernel address",hex:4,initial:e.initial.kernel_addr,value:e.values.kernel_addr},on:{change:function(t){return e.handleChange("kernel_addr",t)}}})],1),n("v-col",{attrs:{cols:"12",lg:"6"}},[n("ImageReplacer",{attrs:{label:"Kernel image","default-name":"kernel.img",initial:e.initial.kernel,value:e.values.kernel},on:{replace:function(t){return e.handleReplace("kernel",t)},remove:function(){return e.handleRemove("kernel")},export:function(){return e.handleExport("kernel","kernel.img")}}})],1)],1),n("v-row",[n("v-col",{attrs:{cols:"6",lg:"3"}},[n("ValuePresenter",{attrs:{label:"Ramdisk size",initial:e.initial.ramdisk_size,value:e.values.ramdisk_size}})],1),n("v-col",{attrs:{cols:"6",lg:"3"}},[n("ValueEditor",{attrs:{label:"Ramdisk address",hex:4,initial:e.initial.ramdisk_addr,value:e.values.ramdisk_addr},on:{change:function(t){return e.handleChange("ramdisk_addr",t)}}})],1),n("v-col",{attrs:{cols:"12",lg:"6"}},[n("ImageReplacer",{attrs:{label:"Ramdisk image","default-name":"ramdisk.cpio.gz",initial:e.initial.ramdisk,value:e.values.ramdisk},on:{replace:function(t){return e.handleReplace("ramdisk",t)},remove:function(){return e.handleRemove("ramdisk")},export:function(){return e.handleExport("ramdisk","ramdisk.cpio.gz")}}})],1)],1),n("v-row",[n("v-col",{attrs:{cols:"6",lg:"3"}},[n("ValuePresenter",{attrs:{label:"2nd-stage BL size",initial:e.initial.second_size,value:e.values.second_size}})],1),n("v-col",{attrs:{cols:"6",lg:"3"}},[n("ValueEditor",{attrs:{label:"2nd-stage BL address",hex:4,initial:e.initial.second_addr,value:e.values.second_addr},on:{change:function(t){return e.handleChange("second_addr",t)}}})],1),n("v-col",{attrs:{cols:"12",lg:"6"}},[n("ImageReplacer",{attrs:{label:"2nd-stage BL image","default-name":"second.img",initial:e.initial.second,value:e.values.second},on:{replace:function(t){return e.handleReplace("second",t)},remove:function(){return e.handleRemove("second")},export:function(){return e.handleExport("second","second.img")}}})],1)],1),n("v-row",[n("v-col",{attrs:{cols:"6",lg:"3"}},[n("ValueEditor",{attrs:{label:"Tags address",hex:4,initial:e.initial.tags_addr,value:e.values.tags_addr},on:{change:function(t){return e.handleChange("tags_addr",t)}}})],1),0==e.values.header_version?n("v-col",{attrs:{cols:"6",lg:"3"}},[n("ValuePresenter",{attrs:{label:"DT size",initial:e.initial.dt_size,value:e.values.dt_size}})],1):e._e(),0==e.values.header_version?n("v-col",{attrs:{cols:"12",lg:"6"}},[n("ImageReplacer",{attrs:{label:"DT image","default-name":"dt.img",initial:e.initial.dt,value:e.values.dt},on:{replace:function(t){return e.handleReplace("dt",t)},remove:function(){return e.handleRemove("dt")},export:function(){return e.handleExport("dt","dt.img")}}})],1):e._e()],1),e.values.header_version>0?n("v-row",[n("v-col",{attrs:{cols:"6",lg:"3"}},[n("ValuePresenter",{attrs:{label:"Recovery DTBO size",initial:e.initial.recovery_dtbo_size,value:e.values.recovery_dtbo_size}})],1),n("v-col",{attrs:{cols:"6",lg:"3"}},[n("ValuePresenter",{attrs:{label:"Recovery DTBO offset",initial:e.initial.recovery_dtbo_offset,value:e.values.recovery_dtbo_offset}})],1),n("v-col",{attrs:{cols:"12",lg:"6"}},[n("ImageReplacer",{attrs:{label:"Recovery DTBO image","default-name":"recovery_dtbo.img",initial:e.initial.recovery_dtbo,value:e.values.recovery_dtbo},on:{replace:function(t){return e.handleReplace("recovery_dtbo",t)},remove:function(){return e.handleRemove("recovery_dtbo")},export:function(){return e.handleExport("recovery_dtbo","recovery_dtbo.img")}}})],1)],1):e._e(),e.values.header_version>1?n("v-row",[n("v-col",{attrs:{cols:"6",lg:"3"}},[n("ValuePresenter",{attrs:{label:"DTB size",initial:e.initial.dtb_size,value:e.values.dtb_size}})],1),n("v-col",{attrs:{cols:"6",lg:"3"}},[n("ValueEditor",{attrs:{label:"DTB address",hex:4,initial:e.initial.dtb_addr,value:e.values.dtb_addr},on:{change:function(t){return e.handleChange("dtb_addr",t)}}})],1),n("v-col",{attrs:{cols:"12",lg:"6"}},[n("ImageReplacer",{attrs:{label:"DTB image","default-name":"dtb.img",initial:e.initial.dtb,value:e.values.dtb},on:{replace:function(t){return e.handleReplace("dtb",t)},remove:function(){return e.handleRemove("dtb")},export:function(){return e.handleExport("dtb","dtb.img")}}})],1)],1):e._e(),n("v-row",[n("v-col",{attrs:{cols:"6",lg:"3"}},[n("ValueEditor",{attrs:{label:"OS patch level",reg:/^\d{4}-\d{2}$/,initial:e.initial.os_patch_level,value:e.values.os_patch_level},on:{change:function(t){return e.handleChange("os_patch_level",t)}}})],1),n("v-col",{attrs:{cols:"6",lg:"3"}},[n("ValueEditor",{attrs:{label:"OS version",reg:/^\d+\.\d+\.\d+$/,initial:e.initial.os_version,value:e.values.os_version},on:{change:function(t){return e.handleChange("os_version",t)}}})],1),n("v-col",{attrs:{cols:"12",lg:"6"}},[n("ValueEditor",{attrs:{label:"Board",initial:e.initial.board,value:e.values.board},on:{change:function(t){return e.handleChange("board",t)}}})],1)],1),n("v-row",[n("v-col",{attrs:{cols:"12"}},[n("TextEditor",{attrs:{label:"cmdline",rows:"3","max-length":1536,initial:e.initial.cmdline,value:e.values.cmdline},on:{change:function(t){return e.handleChange("cmdline",t)}}})],1)],1)],1)},k=[],w=(n("7db0"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-text-field",{staticClass:"monospace",attrs:{label:e.label,value:e.value,messages:e.value!=e.initial?"Modified":"",placeholder:"Not present",disabled:""}})}),E=[],R={name:"ValuePresenter",props:{label:String,initial:null,value:null}},I=R,O=n("6544"),j=n.n(O),B=n("8654"),V=Object(g["a"])(I,w,E,!1,null,null,null),L=V.exports;j()(V,{VTextField:B["a"]});var U=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-text-field",{staticClass:"monospace",attrs:{label:e.label,prefix:e.hex?"0x":"",messages:e.modified?"Modified":"",rules:[e.handleValidate],placeholder:" "},on:{blur:e.handleBlur},scopedSlots:e._u([e.modified?{key:"append",fn:function(){return[n("InlineButton",{attrs:{icon:"mdi-restore",hint:"Reset"},on:{click:e.handleReset}})]},proxy:!0}:null],null,!0),model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})},S=[],C=(n("a9e3"),n("4d63"),n("ac1f"),n("466d"),n("4d90"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[n("v-btn",e._g({staticStyle:{"margin-top":"2px"},attrs:{icon:"","x-small":"",disabled:e.disabled},on:{click:e.handleClick}},a),[n("v-icon",[e._v(e._s(e.icon))])],1)]}}])},[n("span",[e._v(e._s(e.hint))])])}),$=[],P={name:"InlineButton",props:{icon:String,hint:String,disabled:Boolean},methods:{handleClick:function(){this.$emit("click")}}},T=P,D=n("8336"),F=n("132d"),M=n("3a2f"),N=Object(g["a"])(T,C,$,!1,null,null,null),A=N.exports;j()(N,{VBtn:D["a"],VIcon:F["a"],VTooltip:M["a"]});var H={name:"ValueEditor",components:{InlineButton:A},props:{label:String,initial:null,value:null,dec:Boolean,hex:Number,reg:RegExp},data:function(){return{model:this.format(this.initial)}},computed:{modified:function(){return this.value!=this.initial}},watch:{value:function(e){this.model=this.format(e)},model:function(e){var t=this,n=this.parse(e);n!=this.value&&this.$nextTick((function(){t.$emit("change",n)}))}},methods:{handleReset:function(){this.model=this.format(this.initial)},handleValidate:function(e){return this.dec?!isNaN(this.parse(e)):this.hex?!isNaN(this.parse(e))&&e.length==2*this.hex:!this.reg||"string"==typeof e&&!!e.match(this.reg)},handleBlur:function(){this.model=this.format(this.value)},format:function(e){return this.hex>0?isNaN(e)?0:e.toString(16).toUpperCase().padStart(2*this.hex,"0"):this.dec&&isNaN(e)?0:e},parse:function(e){return this.dec?parseInt(e):this.hex?parseInt(e,16):e}}},K=H,J=Object(g["a"])(K,U,S,!1,null,null,null),W=J.exports;j()(J,{VTextField:B["a"]});var q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-select",{staticClass:"monospace",attrs:{items:e.items,label:e.label,messages:e.modified?"Modified":""},scopedSlots:e._u([e.modified?{key:"append-outer",fn:function(){return[n("InlineButton",{attrs:{icon:"mdi-restore",hint:"Reset"},on:{click:e.handleReset}})]},proxy:!0}:null],null,!0),model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})},G=[],Q={name:"SelectEditor",components:{InlineButton:A},props:{label:String,items:Array,initial:null,value:null},data:function(){return{model:this.initial}},computed:{modified:function(){return this.value!=this.initial}},watch:{value:function(e){this.model=e},model:function(e){this.$emit("change",e)}},methods:{handleReset:function(){this.$emit("change",this.initial)}}},X=Q,Y=n("b974"),Z=Object(g["a"])(X,q,G,!1,null,null,null),ee=Z.exports;j()(Z,{VSelect:Y["a"]});var te=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-textarea",{staticClass:"monospace",attrs:{label:e.label,messages:e.modified?"Modified":"",rules:[e.handleValidate],rows:e.rows,placeholder:" ",counter:"","no-resize":""},scopedSlots:e._u([e.modified?{key:"append",fn:function(){return[n("InlineButton",{attrs:{icon:"mdi-restore",hint:"Reset"},on:{click:e.handleReset}})]},proxy:!0}:null],null,!0),model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})},ne=[],ae={name:"TextEditor",components:{InlineButton:A},props:{label:String,initial:String,value:String,maxLength:Number,rows:null},data:function(){return{model:this.initial}},computed:{modified:function(){return this.value!=this.initial}},watch:{value:function(e){this.model=e},model:function(e){this.$emit("change",e)}},methods:{handleReset:function(){this.$emit("change",this.initial)},handleValidate:function(e){return"number"!=typeof this.maxLength||e.length<=this.maxLength},handleBlur:function(){this.model=this.format(this.value)}}},re=ae,ie=n("a844"),le=Object(g["a"])(re,te,ne,!1,null,null,null),se=le.exports;j()(le,{VTextarea:ie["a"]});var oe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-text-field",{staticClass:"monospace",attrs:{label:e.label,value:e.name,messages:e.modified?"Modified":"",placeholder:e.removed?"Removed":"Not present",readonly:""},scopedSlots:e._u([{key:"append",fn:function(){return[e.modified?[n("InlineButton",{attrs:{icon:"mdi-restore",hint:"Reset"},on:{click:e.handleReset}})]:[n("InlineButton",{attrs:{icon:"mdi-dots-vertical",hint:"Replace"},on:{click:e.handleReplace}}),e.presence?n("InlineButton",{attrs:{icon:"mdi-close",hint:"Remove"},on:{click:e.handleRemove}}):e._e()]]},proxy:!0},{key:"append-outer",fn:function(){return[n("InlineButton",{attrs:{icon:"mdi-download",hint:"Export",disabled:!e.presence||e.modified},on:{click:e.handleExport}})]},proxy:!0}])})},ce=[],ue=n("3835"),de=n("36d5"),fe=n.n(de),ve={name:"ImageReplacer",components:{InlineButton:A},props:{label:String,defaultName:String,initial:null,value:null},computed:{name:function(){return this.replaced?this.value.name:this.removed||!this.presence?null:this.defaultName},presence:function(){return null!=this.initial},modified:function(){return this.initial!=this.value},removed:function(){return this.modified&&null==this.value},replaced:function(){return this.modified&&this.value instanceof File}},methods:{handleReplace:function(){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function t(){var n,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fe()();case 2:n=t.sent,a=Object(ue["a"])(n,1),r=a[0],e.$emit("replace",r);case 6:case"end":return t.stop()}}),t)})))()},handleRemove:function(){this.$emit("remove")},handleReset:function(){this.$emit("replace",null)},handleExport:function(){this.$emit("export")}}},he=ve,pe=Object(g["a"])(he,oe,ce,!1,null,null,null),me=pe.exports;j()(pe,{VTextField:B["a"]});var be={name:"Form",components:{ValuePresenter:L,ValueEditor:W,SelectEditor:ee,TextEditor:se,ImageReplacer:me},props:{initial:Object,values:Object},data:function(){return{header_versions:[{value:0,text:"v0",size:null},{value:1,text:"v1",size:1648},{value:2,text:"v2",size:1660}]}},methods:{handleChange:function(e,t){if(this.$emit("change",e,t),"header_version"==e){var n=this.header_versions.find((function(e){return e.value==t})),a=n.size;this.$emit("change","header_size",a)}},handleReplace:function(e,t){this.$emit("replace",e,t)},handleRemove:function(e){this.$emit("remove",e)},handleExport:function(e,t){this.$emit("export",e,t)}}},_e=be,ge=(n("3953"),n("62ad")),xe=n("a523"),ye=n("0fd9"),ze=Object(g["a"])(_e,z,k,!1,null,null,null),ke=ze.exports;j()(ze,{VCol:ge["a"],VContainer:xe["a"],VRow:ye["a"]});n("5cc6"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7");function we(e){return new Promise((function(t,n){var a=new FileReader;a.onload=function(e){return t(new Uint8Array(e.target.result))},a.onabort=function(){return t(null)},a.onerror=function(e){return n(e)},a.readAsArrayBuffer(e)}))}n("99af"),n("fb6a");var Ee=n("1c35"),Re=n("d4ec"),Ie=n("bee2"),Oe=function(){function e(t){Object(Re["a"])(this,e),this.buffer=Ee["Buffer"].from(t),this.ptr=0}return Object(Ie["a"])(e,[{key:"read",value:function(e){var t=this.buffer.slice(this.ptr,this.ptr+e);return this.ptr+=e,t}},{key:"readUInt32LE",value:function(){var e=this.buffer.readUInt32LE(this.ptr);return this.ptr+=4,e}},{key:"readUInt64LE",value:function(){var e=this.buffer.readUInt32LE(this.ptr);return this.ptr+=8,e}},{key:"reset",value:function(){this.ptr=0}},{key:"tell",value:function(){return this.ptr}}]),e}();function je(e,t){return Math.floor((e+t-1)/t)}var Be="ANDROID!";function Ve(e){var t,n={},a=new Oe(e);if(n.magic=a.read(8).toString(),n.magic!=Be)throw new Error("Invalid magic!");n.kernel_size=a.readUInt32LE(),n.kernel_addr=a.readUInt32LE(),n.ramdisk_size=a.readUInt32LE(),n.ramdisk_addr=a.readUInt32LE(),n.second_size=a.readUInt32LE(),n.second_addr=a.readUInt32LE(),n.tags_addr=a.readUInt32LE(),n.page_size=a.readUInt32LE(),t=a.readUInt32LE(),t>2?(n.dt_size=t,n.header_version=0):(n.dt_size=0,n.header_version=t),t=a.readUInt32LE(),n.os_patch_level=function(){var e=t&parseInt("11111111111",2),n=e&parseInt("1111",2),a=2e3+(e>>4);return"".concat(a,"-").concat(n.toString().padStart(2,"0"))}(),n.os_version=function(){var e=t>>11,n=e>>14,a=e>>7&parseInt("1111111",2),r=e&parseInt("1111111",2);return"".concat(n,".").concat(a,".").concat(r)}(),n.board=a.read(16).toString();var r=Ee["Buffer"].alloc(1536);a.read(512).copy(r,0),n.img_id=a.read(32).toString("hex"),a.read(1024).copy(r,512),n.cmdline=Le(r),n.header_version>0?(n.recovery_dtbo_size=a.readUInt32LE(),n.recovery_dtbo_offset=a.readUInt64LE()):(n.recovery_dtbo_size=0,n.recovery_dtbo_offset=0),n.header_version>0?n.header_size=a.readUInt32LE():n.header_size=null,n.header_version>1?(n.dtb_size=a.readUInt32LE(),n.dtb_addr=a.readUInt64LE()):(n.dtb_size=0,n.dtb_addr=0);var i=a.tell();if(i=Ue(i,n.page_size),n.kernel={offset:i,size:n.kernel_size},i=Ue(i+n.kernel_size,n.page_size),n.ramdisk={offset:i,size:n.ramdisk_size},i=Ue(i+n.ramdisk_size,n.page_size),n.second_size>0?(n.second={offset:i,size:n.second_size},i=Ue(i+n.second_size,n.page_size)):n.second=null,n.dt_size>0?(n.dt={offset:i,size:n.dt_size},i=Ue(i+n.dt_size,n.page_size)):n.dt=null,n.recovery_dtbo_size>0){if(n.recovery_dtbo_offset!=i)throw new Error("Mismatch recovery_dtbo_offset!");n.recovery_dtbo={offset:i,size:n.recovery_dtbo_size},i=Ue(i+n.recovery_dtbo_size,n.page_size)}else n.recovery_dtbo=null;return n.dtb_size>0?(n.dtb={offset:i,size:n.dtb_size},i=Ue(i+n.dtb_size,n.page_size)):n.dtb=null,n}function Le(e){for(var t=0;t<e.length;t++)if(0==e[t])return e.slice(0,t).toString();return e.toString()}function Ue(e,t){return t*je(e,t)}function Se(e,t,n){var a=t[n],r=a.offset,i=a.size;return e.slice(r,r+i)}var Ce=n("b85c"),$e=function(){function e(t){Object(Re["a"])(this,e),this.buffer=Ee["Buffer"].alloc(t,0),this.ptr=0}return Object(Ie["a"])(e,[{key:"write",value:function(e){e.copy(this.buffer,this.ptr),this.ptr+=e.length}},{key:"writeUInt32LE",value:function(e){this.buffer.writeUInt32LE(e,this.ptr),this.ptr+=4}},{key:"writeUInt64LE",value:function(e){return this.buffer.writeUInt32LE(e,this.ptr),this.ptr+=8,e}},{key:"skip",value:function(e){this.ptr+=e}},{key:"tell",value:function(){return this.ptr}}]),e}();function Pe(e,t){return Te.apply(this,arguments)}function Te(){return Te=Object(u["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(n instanceof File)){e.next=6;break}return e.next=3,we(n);case 3:return e.abrupt("return",e.sent);case 6:if(!n||"number"!=typeof n.offset||"number"!=typeof n.size){e.next=10;break}return e.abrupt("return",t.slice(n.offset,n.offset+n.size));case 10:return e.abrupt("return",null);case 11:case"end":return e.stop()}}),e)}))),Te.apply(this,arguments)}var De=["kernel","ramdisk","second","dt","recovery_dtbo","dtb"];function Fe(e,t){return Me.apply(this,arguments)}function Me(){return Me=Object(u["a"])(regeneratorRuntime.mark((function e(t,n){var a,r,i,l,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=We(n),r=new $e(a),Ne(r,n),i=Object(Ce["a"])(De),e.prev=4,i.s();case 6:if((l=i.n()).done){e.next=12;break}return s=l.value,e.next=10,Ae(r,t,n[s],n.page_size);case 10:e.next=6;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](4),i.e(e.t0);case 17:return e.prev=17,i.f(),e.finish(17);case 20:return e.abrupt("return",r.buffer);case 21:case"end":return e.stop()}}),e,null,[[4,14,17,20]])}))),Me.apply(this,arguments)}function Ne(e,t){e.write(Ee["Buffer"].from(t.magic)),e.writeUInt32LE(t.kernel_size),e.writeUInt32LE(t.kernel_addr),e.writeUInt32LE(t.ramdisk_size),e.writeUInt32LE(t.ramdisk_addr),e.writeUInt32LE(t.second_size),e.writeUInt32LE(t.second_addr),e.writeUInt32LE(t.tags_addr),e.writeUInt32LE(t.page_size),t.dt_size>0?e.writeUInt32LE(t.dt_size):e.writeUInt32LE(t.header_version),e.writeUInt32LE(Je(t.os_patch_level,t.os_version));var n=Ee["Buffer"].alloc(16,0);Ee["Buffer"].from(t.board||"").copy(n),e.write(n);var a=Ee["Buffer"].alloc(1536,0);Ee["Buffer"].from(t.cmdline).copy(a),e.write(a.slice(0,512));var r=Ee["Buffer"].alloc(32,0);Ee["Buffer"].from(t.img_id,"hex").copy(r),e.write(r),e.write(a.slice(512)),t.header_version>0&&(e.writeUInt32LE(t.recovery_dtbo_size),e.writeUInt64LE(t.recovery_dtbo_offset)),t.header_version>0&&e.writeUInt32LE(t.header_size),t.header_version>1&&(e.writeUInt32LE(t.dtb_size),e.writeUInt64LE(t.dtb_addr)),Ke(e,t.page_size)}function Ae(e,t,n,a){return He.apply(this,arguments)}function He(){return He=Object(u["a"])(regeneratorRuntime.mark((function e(t,n,a,r){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Pe(n,a);case 2:i=e.sent,i&&(t.write(Ee["Buffer"].from(i)),Ke(t,r));case 4:case"end":return e.stop()}}),e)}))),He.apply(this,arguments)}function Ke(e,t){var n=e.tell(),a=t*je(n,t);e.skip(a-n)}function Je(e,t){var n=0;if(t&&t.match(/^(\d+)\.(\d+)\.(\d+)$/)){var a=[parseInt(RegExp.$1),parseInt(RegExp.$2),parseInt(RegExp.$3)],r=a[0],i=a[1],l=a[2];if(r<128&&i<128&&l<128){var s=r<<14|i<<7|l;n|=s<<11}}if(e&&e.match(/^(\d{4})-(\d{2})$/)){var o=[parseInt(RegExp.$1)-2e3,parseInt(RegExp.$2)],c=o[0],u=o[1];if(c>=0&&c<128&&u>0&&u<=12){var d=c<<4|u;n|=d}}return n}function We(e){var t,n=1,a=Object(Ce["a"])(De);try{for(a.s();!(t=a.n()).done;){var r=t.value;n+=je(e["".concat(r,"_size")],e.page_size)}}catch(i){a.e(i)}finally{a.f()}return n*e.page_size}function qe(e,t){return Ge.apply(this,arguments)}function Ge(){return Ge=Object(u["a"])(regeneratorRuntime.mark((function e(t,n){var a,r,i,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=[],e.next=3,Qe(a,t,n.kernel);case 3:return e.next=5,Qe(a,t,n.ramdisk);case 5:return e.next=7,Qe(a,t,n.second);case 7:if(0!=n.header_version){e.next=10;break}return e.next=10,Qe(a,t,n.dt);case 10:if(!(n.header_version>0)){e.next=13;break}return e.next=13,Qe(a,t,n.recovery_dtbo);case 13:if(!(n.header_version>1)){e.next=16;break}return e.next=16,Qe(a,t,n.dtb);case 16:return r=Ee["Buffer"].concat(a),e.next=19,crypto.subtle.digest("SHA-1",r.buffer);case 19:return i=e.sent,l=Ee["Buffer"].alloc(32,0),Ee["Buffer"].from(i).copy(l),e.abrupt("return",l);case 23:case"end":return e.stop()}}),e)}))),Ge.apply(this,arguments)}function Qe(e,t,n){return Xe.apply(this,arguments)}function Xe(){return Xe=Object(u["a"])(regeneratorRuntime.mark((function e(t,n,a){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Pe(n,a);case 2:r=e.sent,r?(r.length>0&&t.push(Ee["Buffer"].from(r)),t.push(Ye(r.length))):t.push(Ye(0));case 4:case"end":return e.stop()}}),e)}))),Xe.apply(this,arguments)}function Ye(e){var t=Ee["Buffer"].alloc(4);return t.writeUInt32LE(e),t}function Ze(e,t){var n=[];function a(){var e,a=1,r=Object(Ce["a"])(n);try{for(r.s();!(e=r.n()).done;){var i=e.value;a+=je(i,t.page_size)}}catch(l){r.e(l)}finally{r.f()}return a*t.page_size}return"kernel"==e?{offset:a(),size:t.kernel_size}:(n.push(t.kernel_size),"ramdisk"==e?{offset:a(),size:t.ramdisk_size}:(n.push(t.ramdisk_size),"second"==e?{offset:a(),size:t.second_size}:(n.push(t.second_size),"dt"==e?{offset:a(),size:t.dt_size}:(n.push(t.dt_size),"recovery_dtbo"==e?{offset:a(),size:t.recovery_dtbo_size}:(n.push(t.recovery_dtbo_size),"dtb"==e?{offset:a(),size:t.dtb_size}:void 0)))))}var et={name:"App",components:{FileDrop:y,Form:ke},data:function(){return{panel:0,file:null,blob:null,initial:{},values:{}}},methods:{handleFile:function(e){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.file=e,e){n.next=3;break}return n.abrupt("return");case 3:return n.prev=3,n.next=6,we(e);case 6:t.blob=n.sent,t.initial=Ve(t.blob),t.values=Object(c["a"])({},t.initial),t.panel=1,n.next=16;break;case 12:n.prev=12,n.t0=n["catch"](3),console.error("Failed parsing image",n.t0),t.file=null;case 16:case"end":return n.stop()}}),n,null,[[3,12]])})))()},handleChange:function(e,t){this.values=Object(c["a"])(Object(c["a"])({},this.values),{},Object(o["a"])({},e,t))},handleResetAll:function(){this.values=Object(c["a"])({},this.initial)},updateRecoveryDtboOffset:function(){var e=Ze("recovery_dtbo",this.values),t=e.offset,n=e.size;this.values=Object(c["a"])(Object(c["a"])({},this.values),{},{recovery_dtbo_offset:n>0?t:0})},updateImageId:Object(f["a"])(200,Object(u["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,qe(this.blob,this.values);case 2:t=e.sent,this.values=Object(c["a"])(Object(c["a"])({},this.values),{},{img_id:t.toString("hex")});case 4:case"end":return e.stop()}}),e,this)})))),handleReplace:function(e,t){var n,a,r="".concat(e,"_size");t?this.values=Object(c["a"])(Object(c["a"])({},this.values),{},(n={},Object(o["a"])(n,e,t),Object(o["a"])(n,r,t.size),n)):this.values=Object(c["a"])(Object(c["a"])({},this.values),{},(a={},Object(o["a"])(a,e,this.initial[e]),Object(o["a"])(a,r,this.initial[r]),a));this.updateRecoveryDtboOffset(),this.updateImageId()},handleRemove:function(e){var t,n="".concat(e,"_size");this.values=Object(c["a"])(Object(c["a"])({},this.values),{},(t={},Object(o["a"])(t,e,null),Object(o["a"])(t,n,0),t)),this.updateRecoveryDtboOffset(),this.updateImageId()},handleExport:function(e,t){var n=Se(this.blob,this.initial,e),a=new Blob([n]);Object(d["saveAs"])(a,t)},handleBuild:function(){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Fe(e.blob,e.values);case 2:n=t.sent,a=new Blob([n]),Object(d["saveAs"])(a,"".concat(e.file.name,"-rebuilt.img"));case 5:case"end":return t.stop()}}),t)})))()}}},tt=et,nt=(n("034f"),n("7496")),at=n("a75b"),rt=n("cd55"),it=n("49e2"),lt=n("c865"),st=n("0393"),ot=Object(g["a"])(tt,l,s,!1,null,null,null),ct=ot.exports;j()(ot,{VApp:nt["a"],VBtn:D["a"],VCol:ge["a"],VContainer:xe["a"],VContent:at["a"],VExpansionPanel:rt["a"],VExpansionPanelContent:it["a"],VExpansionPanelHeader:lt["a"],VExpansionPanels:st["a"],VIcon:F["a"],VRow:ye["a"]}),a["a"].config.productionTip=!1,new a["a"]({vuetify:i,render:function(e){return e(ct)}}).$mount("#app")},"8a23":function(e,t,n){}});
//# sourceMappingURL=app.d0759807.js.map